<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="location.js"></script>
</head>

<body>

</body>
<script>
    let locs = {
        livingRoom: new Location('living room'),
        bedroom: new Location('bedroom'),
        bathroom: new Location('bathroom'),
        heaven: new Location('heaven'),
        hell: new Location('hell')
    };
    let hyperspace = new Location('hyperspace');
    hyperspace.addNeighbors(locs);
    let items = {
        watch: new Item(
            'watch',
            locs.bedroom,
            'Watch ',
            function () {
                let date = new Date();
                alert("It's " + date.getHours() + ':' + date.getMinutes())
                this.loc.interact();
            }),

        teleporter: new Item('teleporter',
            locs.bathroom,
            'Use ',
            function () {
                let password = prompt('Please enter password');
                if(password==='Do geese see God?'){
                    if(confirm('Proceed into hyperspace?')){
                        hyperspace.interact();
                    }
                    else{
                        this.loc.interact();
                    }
                }
                else{
                    alert('Antimatter security system triggered');
                    locs.hell.interact();
                }
                
            }
        ),

        steve: new Item('Steve', locs.bathroom),

        bob: new Item('Bob',
            locs.livingRoom,
            'Talk to ',
            function () {
                prompt('"Hey, my name is Bob, did you know that\'s a palindrome?"');
                while (true) {
                    let name = prompt('"What\'s your name?"').replace(' ', '').toLowerCase();
                    if (name) {

                        if (name === 'bob') {
                            alert('"Yeah, right."');
                        }
                        else if (name === name.split('').reverse().join('')) {
                            alert('"Oh, cool, that\'s a palindrome, bye."');
                            let loc = this.loc;
                            let locs = Array.from(loc.neighbors);
                            this.move(locs[Math.floor(Math.random() * locs.length)]);
                            this.loc.interact();
                        }
                        else {
                            alert("That's not a palindrome though.")
                            if (Math.random() < .1) {
                                let loc = this.loc;
                                this.move(locs.hell);
                                alert('Bob died due to the non-palindromity of your name.');
                                loc.interact();
                            }
                        }
                    }
                }
            }
        )

    };
    items.watch.move(locs.bedroom);

    Location.neighborize(locs.bedroom, locs.livingRoom);
    Location.neighborize(locs.livingRoom, locs.bathroom);

    locs.bedroom.interact();

</script>

</html>